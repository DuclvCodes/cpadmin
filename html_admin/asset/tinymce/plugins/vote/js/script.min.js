$(document).ready(function(){function d(){$(".js_close").removeClass("js_close").click(function(){$(this).parents(".control-group").remove();b--;3==b&&$(".icon-remove").addClass("hide");var a=1;$(".icon-remove").each(function(){$(this).parents(".control-group").find("input").attr("placeholder","L\u1ef1a ch\u1ecdn "+a);a++});return!1})}var c=tinyMCEPopup.editor.selection.getNode();if("DIV"==c.nodeName&&"tkp_area_vote"==$(c).attr("class")){var e=$(c).find(".vote_id").text();$.ajax({type:"GET",url:"/api/getVote?id="+
e,dataType:"html",success:function(a){a=jQuery.parseJSON(a);$("#frm_vote input[name=vote_id]").val(e);$("#frm_vote textarea[name=title]").val(a.title);1==a.is_predict&&$("#frm_vote input[name=is_predict]").attr("checked","checked");a=jQuery.parseJSON(a.answers);$.each(a,function(a,f){1<a&&$(".add_choose").click();$("#frm_vote .icon-remove:eq("+a+")").parents(".control-group").find("input").val(f)});$("#lbl_submit").text("C\u1eadp nh\u1eadt")},error:function(a,b){alert("Can't do because: "+b)}})}var b=
3;$(".add_choose").click(function(){$(this).parents(".control-group").before('<div class="control-group"><div class="controls"><input name="answers[]" value="" class="m-wrap required" placeholder="L\u1ef1a ch\u1ecdn '+b+'" /><i class="icon-remove js_close"></i></div></div>');d();b++;4==b&&$(".icon-remove").removeClass("hide");$(".icon-remove:last").parents(".control-group").find("input").focus();return!1});d();$("#frm_vote .required").each(function(){var a=$(this).parents(".control-group");$(this).keyup(function(){a.hasClass("error")&&
a.removeClass("error")});$(this).change(function(){a.hasClass("error")&&a.removeClass("error")})});$("#frm_vote").submit(function(){var a=!1;$(this).find(".required").each(function(){var b=$(this).val();b&&""!=b&&"0"!=b||($(this).parents(".control-group").addClass("error"),a=!0)});if(1==a)return $(this).find(".error:eq(0) .required").focus(),alert("Vui l\u00f2ng nh\u1eadp \u0111\u1ea7y \u0111\u1ee7 th\u00f4ng tin"),!1;var b=$(this).attr("action");$.ajax({type:"POST",url:b,data:$("#frm_vote").serialize(),
dataType:"html",success:function(a){0<$("#frm_vote input[name=vote_id]").val()&&$(c).remove();tinyMCEPopup.editor.execCommand("mceInsertContent",!1,a);tinyMCEPopup.close()},error:function(a,b){alert("Can't do because: "+b)}});return!1})});